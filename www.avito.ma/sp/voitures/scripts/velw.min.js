typeof VerboliaLinking == "undefined" &&
    (window.VerboliaLinking = function(n, t, i, r) {
        this.indexChild = 0;
        this.clientUrl = n;
        this.relevancySize = t;
        this.smartSize = i;
        this.domainResourceUrl = r;
        var u = this;
        document.readyState !== "loading" ?
            u.start() :
            document.addEventListener ?
            document.addEventListener("DOMContentLoaded", () => {
                u.start();
            }) :
            document.attachEvent("onreadystatechange", function() {
                document.readyState === "complete" && u.start();
            });
    });
VerboliaLinking.prototype.start = function() {
    var i = this,
        t,
        f,
        r,
        n;
    if (
        (i.clearPreviousBlocks(),
            (t = new XMLHttpRequest()),
            (t.onreadystatechange = function() {
                var n, r;
                t.readyState === XMLHttpRequest.DONE &&
                    t.status === 200 &&
                    t.responseText !== undefined &&
                    t.responseText !== "" &&
                    ((n = JSON.parse(t.responseText)),
                        n.InternalLinks !== undefined &&
                        n.InternalLinks !== null &&
                        n.InternalLinks.length > 0 ?
                        ((r = i.getHtmlResult(n.InternalLinks)),
                            i.injectNewHtmlResult(r),
                            i.getCssStyle()) :
                        n !== undefined &&
                        n !== null &&
                        n.length > 0 &&
                        ((r = i.getHtmlResult(n)),
                            i.injectNewHtmlResult(r),
                            i.getCssStyle()));
            }),
            (f = this.clientUrl),
            (r = this.getSearchTerms()),
            r !== "")
    ) {
        var e = this.relevancySize,
            o = this.smartSize,
            u = window.location.href;
        u.indexOf("#") > 0 && (u = window.location.href.split("#")[0]);
        n = "{apiUrl}?url={url}&st={st}&relevantSize={rls}&smartSize={sls}";
        n = n.replace("{apiUrl}", f);
        n = n.replace("{url}", u);
        n = n.replace("{st}", encodeURIComponent(r));
        n = n.replace("{rls}", e);
        n = n.replace("{sls}", o);
        t.open("GET", n, !0);
        t.send();
    }
};
VerboliaLinking.prototype.injectStyles = function(n) {
    var t = document.createElement("style");
    t.innerHTML = n;
    document.head.insertAdjacentElement("beforeEnd", t);
};
VerboliaLinking.prototype.getSearchTerms = function() {
    var t = [],
        n;
    return (
        document.querySelector("title").length ?
        ((titleHone = document
                .querySelector("title")
                .innerText.split(" | ")[0]),
            (t = titleHone)) :
        document.querySelector("h1") &&
        ((n = document.querySelector("h1").innerText),
            (n = n.split(" | ")[0]),
            (t = n)),
        console.log("1"),
        t
    );
};
VerboliaLinking.prototype.getHtmlResult = function(n) {
    var t = `<h2 class="similar-products-header">Recommandations</h2><div class="similar-products-list">`,
        i = 0,
        r = 10;
    return (
        n.forEach(function(n) {
            i >= r ||
                ((t += `<a class="similar-products-item" href=${n.Url}>${n.DisplayName}</a>`),
                    i++);
        }),
        (t += `</div>`),
        console.log("done test 2"),
        t
    );
};
VerboliaLinking.prototype.injectNewHtmlResult = function(n) {
    var t = document.createElement("div"),
        i,
        r;
    t.innerHTML = n;
    t.className = "similar-products";
    i = document.querySelector("footer");
    r = i.parentNode;
    r.insertBefore(t, i);
    console.log("3");
};
VerboliaLinking.prototype.getCssStyle = function() {
    var t = document.getElementsByTagName("HEAD")[0],
        n = document.createElement("link");
    n.rel = "stylesheet";
    n.type = "text/css";
    n.href = this.domainResourceUrl + "/css/ve-linking.min.css?" + this.version;
    t.appendChild(n);
};
VerboliaLinking.prototype.clearPreviousBlocks = function() {
    console.log("clearing");
    document
        .querySelectorAll(".similar-product-wrapper")
        .forEach((n) => n.remove());
    document.querySelectorAll(".recommendations").forEach((n) => n.remove());
    document.querySelectorAll(".similar-products").forEach((n) => n.remove());
    document.head.querySelectorAll("link").forEach((n) => {
        n.src &&
            n.src.startsWith(this.domainResourceUrl + "/css/ve-linking.min.css") &&
            n.parentNode.removeChild(n);
    });
    document.querySelectorAll(".link-section-bottom").forEach((n) => n.remove());
    document.head.querySelectorAll("link").forEach((n) => {
        n.src &&
            n.src.startsWith(this.domainResourceUrl + "/css/ve-linking.min.css") &&
            n.parentNode.removeChild(n);
    });
    console.log("4");
};
VerboliaLinking.prototype.version = new Date().getTime();
console.log(VerboliaLinking.prototype.version);
new VerboliaLinking(
    "https://www.avito.ma/sp/api/links",
    7,
    3,
    "/sp/voitures"
);